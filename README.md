<a href="https://matplotlib.org">
    <img align="right" src="https://custom-icon-badges.herokuapp.com/badge/Matplotlib-14354C.svg?logo=matplotlib" alt="Matplotlib">
</a>

<a href="https://numpy.org">
    <img align="right" src="https://custom-icon-badges.herokuapp.com/badge/NumPy-14354C.svg?logo=numpylogo" alt="NumPy">
</a>

<a href="https://www.tensorflow.org">
    <img align="right" src="https://img.shields.io/badge/TensorFlow-FF6F00.svg?logo=TensorFlow&logoColor=white" alt="TensorFlow">
</a>

<a href="https://keras.io">
    <img align="right" src="https://img.shields.io/badge/Keras-D00000.svg?logo=Keras&logoColor=white" alt="Keras">
</a>

<a href="https://www.python.org">
    <img align="right" src="https://custom-icon-badges.herokuapp.com/badge/Python-14354C.svg?logo=pythonlogo" alt="Python">
</a>

<h1 align="center">üß† Convolutional Neural Network ü§ñ</h1>


<p align="center">
    <img src="./assets/CNN Code.png" alt="Convolutional Neural Network Code">
    <sub>¬∑ Implementation of CNN for Natural Images Classifier ¬∑</sub>
</p>


## üß† Previous considerations

The dataset used for the construction of the model is perfectly balanced since an unbalanced dataset is detrimental to the training of the network. In other words, each of the different classes that make up the dataset has the same number of images.

The images in the dataset must be well centered and occupy as much of the image as possible, since filters will be used, so it is necessary to extract the characteristic patterns present in each of the images. This is because, if we have an image very much on the left edge, it will go through the image from left to right, so it would detect the feature present, however, the rest of the image would be invalid and, therefore, it would not detect the features it might have.


## üìö Explanation of code layers:

- ***Dropout Layer***

Dropout is a regularization technique for neural network models proposed by Nitish Srivastava in their 2014 paper Dropout: A Simple Way to Prevent Neural Networks from Overfitting [(download the paper).](https://jmlr.org/papers/volume15/srivastava14a/srivastava14a.pdf)

Dropout is a technique where randomly selected neurons are switched off during the training phase. They are ‚Äúdropped out‚Äù randomly. This means that their contribution to the activation of downstream neurons is temporally removed. As a neural network learns, neutron weights settle into their context within the network. Weights of neurons are tuned for specific features providing some specialization according to the features of the dataset.

Neighboring neurons become to rely on this specialization, which if taken too far can result in a fragile model too specialized for the training data. This reliance on a neuron during training is referred to as complex co-adaptations and is an overfitting effect of the network to the training dataset.

You can imagine that if neurons are randomly dropped out of the network during training, those other neurons will have to step in and handle the representation required to make predictions for the missing neurons. This is believed to result in multiple independent internal representations being learned by the network.

Therefore the effect is that the network becomes less sensitive to the specific weights of neurons. This in turn results in a network that is capable of better generalization and is less likely to overfit the training data.

- ***Flatten Layer***

Flattening is converting the data into a 1-dimensional array for inputting it to the next convolutional layer. We flatten the output of the convolutional layers to create a single long feature vector and it is connected to the final classification model, which is called a fully-connected layer.

- ***Dense Layer***

The dense layer is a neural network layer that is deeply connected with its preceding layer which means the neurons of the layer are connected to every neuron of its preceding layer. This layer is the most commonly used in neural network networks.

The dense layer‚Äôs neuron in a model receives output from every neuron of its preceding layer, where neurons of the dense layer perform matrix-vector multiplication. The values used in the matrix are parameters that can be trained and updated with the help of backpropagation.

The output generated by the dense layer is an ‚Äòm‚Äô dimensional vector. Thus, the dense layer is basically used for changing the dimensions of the vector. Dense layers also apply operations like rotation, scaling, and translation on the vector.

- ***Crossentropy Function***

The objective is to develop an image classifier neural network with various classes. In order to achieve this objective satisfactorily, the accuracy percentage of the network is sought to be as high as possible, thus indicating that the overfitting effect has been reduced and that the network is reliable. To prevent the overfitting that the neural network may suffer, changes are made to the number of filters that are applied to it, estimating the percentage error of the network according to the following function:

Loss Function: `-log(error)`

- ***Confusion Matrix***

A confusion matrix is a tool that allows visualization of the performance of a neural network. Each column of the matrix represents the number of predictions in each class, while each row represents the instances in the actual class. One of the benefits of confusion matrices is that they make it easy to see if the system is confusing two classes.

<img src="./assets/Confusion Matrix.png" alt="Confusion Matrix" height="400px" width="600px">

Accuracy = `TP(maximum value is sought)/TP+FP(minimum value is sought)` ‚Üí It allows us to know the False Positives.

Recall = `TP(maximum value is sought)/TP+FN(minimum value is sought)` ‚Üí It allows us to know the False Negatives.

F1-Score = `2*precisi√≥n*recall/precisi√≥n+recall(They are intended to take the highest values possible)` ‚Üí Combines Precision and Recall metrics into a single metric


## üîé Data Augmentation

<ins>
What is Data Augmentation?
</ins>

Data augmentation is a technique that can be used to artificially enlarge the size of a training set by creating modified data from the existing one. It is good practice to use data augmentation if you want to avoid overfitting the neural network, or the initial data set is too small to train on, or even if you want to squeeze better performance out of the model.

The code implemented to apply the data augmentation to a dataset is available for downloading [here.](./data_augmentation.py)


## üñºÔ∏è Training and validation dataset

The dataset used for the training and validation of the developed convolutional neural network is available [here.](https://www.kaggle.com/datasets/briansurezsantiago/natural-images)


## üíæ Expected Outputs

The result of the neural network run with the adjustment of the corresponding hyperparameters is available [here.](./docs/)

<hr>
<p align="center">
Made with ‚ô•Ô∏è in Spain
</p>
